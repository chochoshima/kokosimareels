<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" id="main-desc-meta" content="Temukan prompt AI cinematic gratis.">

    <title>Loading Prompt... | Kokosima AI</title>

    <meta property="og:type" content="article">
    <meta property="og:title" id="meta-title" content="Kokosima AI">
    <meta property="og:description" id="meta-desc" content="Temukan prompt AI cinematic gratis.">
    <meta property="og:url" id="meta-url" content="https://kokosimareels.pages.dev/">
    <meta property="og:image" id="meta-img" content="https://kokosimareels.pages.dev/images/default-preview.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">

    <link rel="stylesheet" href="style.css">

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const currentId = urlParams.get('id');
        const canonical = document.createElement('link');
        canonical.rel = 'canonical';
        canonical.href = currentId ? `https://kokosimareels.pages.dev/prompt.html?id=${currentId}` : 'https://kokosimareels.pages.dev/';
        document.head.appendChild(canonical);
    </script>
	<link rel="manifest" href="manifest.json">
	<meta name="theme-color" content="#000000">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
</head>

<body>

<header class="top-bar">
    <a href="index.html" class="btn-back">â† BACK</a>
    <a href="index.html" class="logo">Kokosima</a>
</header>

<main class="prompt-page-wrapper">
  <div class="prompt-card">
    <div class="media-container">
      <img id="main-image" alt="Prompt Preview" hidden style="width:100%; height:100%; object-fit:cover;">
    </div>
    <div class="content-container">
      <h3 id="title">Loading...</h3>
      <p id="promptText">Memuat prompt...</p>
      <div class="actions">
        <button class="btn btn-primary" id="copyBtn">ğŸ“‹ Copy Prompt</button>
      </div>
      <div class="floating-visitor" id="visitorBar">
        ğŸ‘ï¸ <span id="visitorToday">0</span> hari ini Â·
        <strong id="visitorTotal">0</strong> total
      </div>
    </div>
  </div>
</main>

<script src="data.js"></script>
<script>
/* =========================
   LOAD PROMPT DATA
========================= */
const params = new URLSearchParams(window.location.search);
const promptId = params.get("id");
const domain = "https://kokosimareels.pages.dev";

// Cek apakah data ada
if (!promptId || typeof PROMPT_DATABASE === "undefined" || !PROMPT_DATABASE[promptId]) {
    window.location.href = "index.html";
} else {
    const data = PROMPT_DATABASE[promptId];
    const cleanDesc = data.text.slice(0, 150).replace(/(\r\n|\n|\r)/gm, " ");

    // 1. UPDATE SEO & META (Sangat Penting)
    document.title = data.title + " | Kokosima AI";
    
    // Ganti meta description (standard & OG)
    document.getElementById("main-desc-meta").setAttribute("content", cleanDesc);
    document.getElementById("meta-desc").setAttribute("content", cleanDesc);
    document.getElementById("meta-title").setAttribute("content", data.title);
    document.getElementById("meta-img").setAttribute("content", `${domain}/images/${promptId}.webp`);
    document.getElementById("meta-url").setAttribute("content", window.location.href);

    // 2. INJECT SCHEMA DATA
    const schemaData = {
        "@context": "https://schema.org/",
        "@type": "VisualArtwork",
        "name": data.title,
        "description": cleanDesc,
        "image": `${domain}/images/${promptId}.webp`,
        "creator": { "@type": "Person", "name": "Kokosima AI" }
    };
    const schemaScript = document.createElement('script');
    schemaScript.type = 'application/ld+json';
    schemaScript.text = JSON.stringify(schemaData);
    document.head.appendChild(schemaScript);

    // 3. TAMPILKAN KONTEN DI HALAMAN
    document.getElementById("title").textContent = data.title;
    document.getElementById("promptText").textContent = data.text;
    
    const imgElement = document.getElementById("main-image");
    imgElement.src = `${domain}/images/${promptId}.webp`;
    imgElement.onerror = () => { imgElement.src = `${domain}/images/${promptId}.jpg`; imgElement.onerror = null; };
    imgElement.onload = () => { imgElement.hidden = false; };

    // 4. COPY BUTTON
    document.getElementById("copyBtn").onclick = async () => {
        try {
            await navigator.clipboard.writeText(data.text);
            const btn = document.getElementById("copyBtn");
            btn.textContent = "âœ… Copied";
            setTimeout(() => btn.textContent = "ğŸ“‹ Copy Prompt", 1600);
        } catch {
            alert("Gagal menyalin prompt");
        }
    };
}
</script>
<script src="visitor.js" defer></script>
</body>
</html>
