<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Kokosima AI - Katalog Prompt Cinematic</title>

    <meta name="description" content="Koleksi prompt AI Cinematic gratis untuk Midjourney, Dall-E, dan Stable Diffusion.">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Kokosima AI">
    <meta property="og:description" content="Koleksi prompt AI Cinematic gratis dan inspirasi gambar AI terbaru.">
    <meta property="og:image" content="https://kokosimareels.pages.dev/images/default-preview.jpg">
    <meta name="google-site-verification" content="sFMgW89eT9aIsDnRR-9xdOmZPKxlmcFDILNTJJ0bCMY">

    <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- HEADER -->
<header class="top-bar">
    <a href="index.html" style="text-decoration:none;color:inherit;">
        <span class="logo">üß† kokosima</span>
    </a>
</header>

<!-- VISITOR BAR -->
<div class="visitor-bar">
    üëÅÔ∏è <span id="visitor-today">0</span> hari ini ¬∑ 
    <span id="visitor-total">0</span> total
</div>

<!-- FEED -->
<main class="feed" id="main-feed"></main>

<!-- DATA -->
<script src="data.js"></script>

<script>
/* ==========================
   VIEWPORT MOBILE HEIGHT
========================== */
function setVh(){
    const vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);
}
window.addEventListener('resize', setVh);
window.addEventListener('load', setVh);
setVh();

/* ==========================
   FEED GENERATOR
========================== */
const CHANNEL_YOUTUBE = "https://youtube.com/@kokosimaabsurd";
const feedContainer = document.getElementById("main-feed");

function generateFeed() {
    Object.keys(PROMPT_DATABASE).reverse().forEach(id => {
        const data = PROMPT_DATABASE[id];
        const words = data.text ? data.text.split(/\s+/) : [];
        const previewText = words.slice(0, 12).join(" ") + "...";

        const hasVideo = data.videoUrl && data.videoUrl !== "#";
        const btnLabel = hasVideo ? "‚ñ∂ Video" : "üì∫ Channel";
        const btnHref = hasVideo ? data.videoUrl : CHANNEL_YOUTUBE;
        const btnStyle = hasVideo ? "" : "style='background:#cc0000;color:#fff;'";

        feedContainer.innerHTML += `
            <section class="item" id="${id}">
                <div class="media-container">
                    <img 
                      src="images/${id}.webp"
                      alt="Prompt AI ${data.title}"
                      loading="lazy"
                      decoding="async"
                      onerror="this.onerror=null;this.src='images/${id}.jpg';">
                </div>
                <div class="content-container">
                    <h3>${data.title}</h3>
                    <p class="prompt-preview">${previewText}</p>
                    <div class="actions">
                        <a class="btn btn-primary" href="${btnHref}" target="_blank" ${btnStyle}>${btnLabel}</a>
                        <a class="btn btn-outline" href="prompt.html?id=${id}">PROMPT</a>
                        <button class="btn btn-share" onclick="sharePrompt('${id}')">üîó Share</button>
                    </div>
                </div>
            </section>
        `;
    });
}

generateFeed();

/* ==========================
   SHARE PROMPT
========================== */
function sharePrompt(id) {
    const data = PROMPT_DATABASE[id];
    if (!data) return;

    const base = location.origin + location.pathname.replace("index.html", "");
    const url = base + "prompt.html?id=" + id;

    if (navigator.share) {
        navigator.share({ title: data.title, url });
    } else {
        window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`);
    }
}

/* ==========================
   VISITOR COUNTER (HOME)
========================== */
fetch("https://kokosima-visitor.kokopujiyanto.workers.dev/?page=index")
    .then(res => res.json())
    .then(data => {
        document.getElementById("visitor-today").textContent = data.today;
        document.getElementById("visitor-total").textContent = data.total;
    })
    .catch(err => console.error("Visitor error:", err));
</script>

</body>
</html>
